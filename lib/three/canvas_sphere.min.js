$(function(){var e,t,r,i=window.innerWidth,n=window.innerHeight,o=0,a=0,s=window.innerWidth/2,l=window.innerHeight/2;function c(){s=window.innerWidth/2,l=window.innerHeight/2,e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight)}function p(e){o=e.clientX-s,a=e.clientY-l}function d(e){e.touches.length>1&&(o=e.touches[0].pageX-s)}function E(e){1==e.touches.length&&(o=e.touches[0].pageX-s)}!function(){var o,a;(o=document.createElement("div")).style.position="fixed",o.style.top="0px",o.style.left="0px",o.style.zIndex="-1",o.style.opacity="0.5",document.body.appendChild(o),(e=new THREE.PerspectiveCamera(75,i/n,1,1e4)).position.z=1e3,t=new THREE.Scene,(r=new THREE.CanvasRenderer).setClearColor(16119801,0),r.setPixelRatio(window.devicePixelRatio),r.setSize(i,n),o.appendChild(r.domElement);for(var s=2*Math.PI,l=new THREE.SpriteCanvasMaterial({color:10263708,program:function(e){e.beginPath(),e.arc(0,0,.5,0,s,!0),e.fill()}}),h=0;h<1e3;h++)(a=new THREE.Sprite(l)).position.x=2*Math.random()-1,a.position.y=2*Math.random()-1,a.position.z=2*Math.random()-1,a.position.normalize(),a.position.multiplyScalar(10*Math.random()+450),a.scale.multiplyScalar(2),t.add(a);for(h=0;h<300;h++){var f=new THREE.Geometry,u=new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);u.normalize(),u.multiplyScalar(450),f.vertices.push(u);var m=u.clone();m.multiplyScalar(.3*Math.random()+1),f.vertices.push(m);var v=new THREE.Line(f,new THREE.LineBasicMaterial({color:10263708,opacity:Math.random()}));t.add(v)}document.addEventListener("mousemove",p,!1),document.addEventListener("touchstart",d,!1),document.addEventListener("touchmove",E,!1),window.addEventListener("resize",c,!1)}(),function i(){requestAnimationFrame(i),e.position.x+=.05*(o-e.position.x),e.position.y+=.05*(200-a-e.position.y),e.lookAt(t.position),r.render(t,e)}()}),THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0,this.renderOrder=0},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0,this.renderOrder=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null,this.renderOrder=0},THREE.Projector=function(){var e,t,r,i,n,o,a,s,l,c,p,d=[],E=0,h=[],f=0,u=[],m=0,v=[],R=0,x=[],y=0,T={objects:[],lights:[],elements:[]},w=new THREE.Vector3,H=new THREE.Vector4,g=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),S=new THREE.Box3,M=new Array(3),C=(new Array(4),new THREE.Matrix4),b=new THREE.Matrix4,z=new THREE.Matrix4,V=new THREE.Matrix3,j=new THREE.Frustum,L=new THREE.Vector4,O=new THREE.Vector4;this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var B=new function(){var e=[],t=[],i=null,o=null,s=new THREE.Matrix3;function l(e){var t=e.position,r=e.positionWorld,i=e.positionScreen;r.copy(t).applyMatrix4(p),i.copy(r).applyMatrix4(b);var n=1/i.w;i.x*=n,i.y*=n,i.z*=n,e.visible=i.x>=-1&&i.x<=1&&i.y>=-1&&i.y<=1&&i.z>=-1&&i.z<=1}function c(e,t,r){return!0===e.visible||!0===t.visible||!0===r.visible||(M[0]=e.positionScreen,M[1]=t.positionScreen,M[2]=r.positionScreen,g.intersectsBox(S.setFromPoints(M)))}function d(e,t,r){return(r.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(r.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0}return{setObject:function(r){o=(i=r).material,s.getNormalMatrix(i.matrixWorld),e.length=0,t.length=0},projectVertex:l,checkTriangleVisibility:c,checkBackfaceCulling:d,pushVertex:function(e,t,i){(r=W()).position.set(e,t,i),l(r)},pushNormal:function(t,r,i){e.push(t,r,i)},pushUv:function(e,r){t.push(e,r)},pushLine:function(e,t){var r=h[e],n=h[t];(a=k()).id=i.id,a.v1.copy(r),a.v2.copy(n),a.z=(r.positionScreen.z+n.positionScreen.z)/2,a.renderOrder=i.renderOrder,a.material=i.material,T.elements.push(a)},pushTriangle:function(r,a,l){var p=h[r],E=h[a],f=h[l];if(!1!==c(p,E,f)&&(o.side===THREE.DoubleSide||!0===d(p,E,f))){(n=P()).id=i.id,n.v1.copy(p),n.v2.copy(E),n.v3.copy(f),n.z=(p.positionScreen.z+E.positionScreen.z+f.positionScreen.z)/3,n.renderOrder=i.renderOrder,n.normalModel.fromArray(e,3*r),n.normalModel.applyMatrix3(s).normalize();for(var u=0;u<3;u++){var m=n.vertexNormalsModel[u];m.fromArray(e,3*arguments[u]),m.applyMatrix3(s).normalize(),n.uvs[u].fromArray(t,2*arguments[u])}n.vertexNormalsLength=3,n.material=i.material,T.elements.push(n)}}}};function W(){if(i===f){var e=new THREE.RenderableVertex;return h.push(e),f++,i++,e}return h[i++]}function P(){if(o===m){var e=new THREE.RenderableFace;return u.push(e),m++,o++,e}return u[o++]}function k(){if(s===R){var e=new THREE.RenderableLine;return v.push(e),R++,s++,e}return v[s++]}function N(){if(c===y){var e=new THREE.RenderableSprite;return x.push(e),y++,c++,e}return x[c++]}function F(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}this.projectScene=function(r,f,u,m){function v(r){(e=function(){if(t===E){var e=new THREE.RenderableObject;return d.push(e),E++,t++,e}return d[t++]}()).id=r.id,e.object=r,w.setFromMatrixPosition(r.matrixWorld),w.applyMatrix4(b),e.z=w.z,e.renderOrder=r.renderOrder,T.objects.push(e)}o=0,s=0,c=0,T.elements.length=0,!0===r.autoUpdate&&r.updateMatrixWorld(),null===f.parent&&f.updateMatrixWorld(),C.copy(f.matrixWorldInverse.getInverse(f.matrixWorld)),b.multiplyMatrices(f.projectionMatrix,C),j.setFromMatrix(b),t=0,T.objects.length=0,T.lights.length=0,r.traverseVisible(function(e){if(e instanceof THREE.Light)T.lights.push(e);else if(e instanceof THREE.Mesh||e instanceof THREE.Line){if(!1===e.material.visible)return;if(!0===e.frustumCulled&&!1===j.intersectsObject(e))return;v(e)}else if(e instanceof THREE.Sprite){if(!1===e.material.visible)return;if(!0===e.frustumCulled&&!1===j.intersectsSprite(e))return;v(e)}}),!0===u&&T.objects.sort(F);for(var R=0,x=T.objects.length;R<x;R++){var y=T.objects[R].object,g=y.geometry;if(B.setObject(y),p=y.matrixWorld,i=0,y instanceof THREE.Mesh){if(g instanceof THREE.BufferGeometry){var S=g.attributes,M=g.groups;if(void 0===S.position)continue;for(var A=0,I=(we=S.position.array).length;A<I;A+=3)B.pushVertex(we[A],we[A+1],we[A+2]);if(void 0!==S.normal){var D=S.normal.array;for(A=0,I=D.length;A<I;A+=3)B.pushNormal(D[A],D[A+1],D[A+2])}if(void 0!==S.uv){var G=S.uv.array;for(A=0,I=G.length;A<I;A+=2)B.pushUv(G[A],G[A+1])}if(null!==g.index){var U=g.index.array;if(M.length>0)for(var q=0;q<M.length;q++){var X=M[q];for(A=X.start,I=X.start+X.count;A<I;A+=3)B.pushTriangle(U[A],U[A+1],U[A+2])}else for(A=0,I=U.length;A<I;A+=3)B.pushTriangle(U[A],U[A+1],U[A+2])}else for(A=0,I=we.length/3;A<I;A+=3)B.pushTriangle(A,A+1,A+2)}else if(g instanceof THREE.Geometry){var J=g.vertices,Y=g.faces,$=g.faceVertexUvs[0];V.getNormalMatrix(p);for(var K=y.material,Q=K instanceof THREE.MultiMaterial,Z=!0===Q?y.material:null,_=0,ee=J.length;_<ee;_++){var te=J[_];if(w.copy(te),!0===K.morphTargets)for(var re=g.morphTargets,ie=y.morphTargetInfluences,ne=0,oe=re.length;ne<oe;ne++){var ae=ie[ne];if(0!==ae){var se=re[ne].vertices[_];w.x+=(se.x-te.x)*ae,w.y+=(se.y-te.y)*ae,w.z+=(se.z-te.z)*ae}}B.pushVertex(w.x,w.y,w.z)}for(var le=0,ce=Y.length;le<ce;le++){var pe=Y[le];if(void 0!==(K=!0===Q?Z.materials[pe.materialIndex]:y.material)){var de=K.side,Ee=h[pe.a],he=h[pe.b],fe=h[pe.c];if(!1!==B.checkTriangleVisibility(Ee,he,fe)){var ue=B.checkBackfaceCulling(Ee,he,fe);if(de!==THREE.DoubleSide){if(de===THREE.FrontSide&&!1===ue)continue;if(de===THREE.BackSide&&!0===ue)continue}(n=P()).id=y.id,n.v1.copy(Ee),n.v2.copy(he),n.v3.copy(fe),n.normalModel.copy(pe.normal),!1!==ue||de!==THREE.BackSide&&de!==THREE.DoubleSide||n.normalModel.negate(),n.normalModel.applyMatrix3(V).normalize();for(var me=pe.vertexNormals,ve=0,Re=Math.min(me.length,3);ve<Re;ve++){var xe=n.vertexNormalsModel[ve];xe.copy(me[ve]),!1!==ue||de!==THREE.BackSide&&de!==THREE.DoubleSide||xe.negate(),xe.applyMatrix3(V).normalize()}n.vertexNormalsLength=me.length;var ye=$[le];if(void 0!==ye)for(var Te=0;Te<3;Te++)n.uvs[Te].copy(ye[Te]);n.color=pe.color,n.material=K,n.z=(Ee.positionScreen.z+he.positionScreen.z+fe.positionScreen.z)/3,n.renderOrder=y.renderOrder,T.elements.push(n)}}}}}else if(y instanceof THREE.Line){if(g instanceof THREE.BufferGeometry){if(void 0!==(S=g.attributes).position){var we;for(A=0,I=(we=S.position.array).length;A<I;A+=3)B.pushVertex(we[A],we[A+1],we[A+2]);if(null!==g.index)for(A=0,I=(U=g.index.array).length;A<I;A+=2)B.pushLine(U[A],U[A+1]);else{var He=y instanceof THREE.LineSegments?2:1;for(A=0,I=we.length/3-1;A<I;A+=He)B.pushLine(A,A+1)}}}else if(g instanceof THREE.Geometry){if(z.multiplyMatrices(b,p),0===(J=y.geometry.vertices).length)continue;for((Ee=W()).positionScreen.copy(J[0]).applyMatrix4(z),He=y instanceof THREE.LineSegments?2:1,_=1,ee=J.length;_<ee;_++)(Ee=W()).positionScreen.copy(J[_]).applyMatrix4(z),(_+1)%He>0||(he=h[i-2],L.copy(Ee.positionScreen),O.copy(he.positionScreen),!0==(Se=L,Me=O,Ce=void 0,be=void 0,void 0,void 0,void 0,void 0,Ce=0,be=1,ze=Se.z+Se.w,Ve=Me.z+Me.w,je=-Se.z+Se.w,Le=-Me.z+Me.w,ze>=0&&Ve>=0&&je>=0&&Le>=0||!(ze<0&&Ve<0||je<0&&Le<0)&&(ze<0?Ce=Math.max(Ce,ze/(ze-Ve)):Ve<0&&(be=Math.min(be,ze/(ze-Ve))),je<0?Ce=Math.max(Ce,je/(je-Le)):Le<0&&(be=Math.min(be,je/(je-Le))),!(be<Ce||(Se.lerp(Me,Ce),Me.lerp(Se,1-be),0))))&&(L.multiplyScalar(1/L.w),O.multiplyScalar(1/O.w),(a=k()).id=y.id,a.v1.positionScreen.copy(L),a.v2.positionScreen.copy(O),a.z=Math.max(L.z,O.z),a.renderOrder=y.renderOrder,a.material=y.material,y.material.vertexColors===THREE.VertexColors&&(a.vertexColors[0].copy(y.geometry.colors[_]),a.vertexColors[1].copy(y.geometry.colors[_-1])),T.elements.push(a)))}}else if(y instanceof THREE.Sprite){H.set(p.elements[12],p.elements[13],p.elements[14],1),H.applyMatrix4(b);var ge=1/H.w;H.z*=ge,H.z>=-1&&H.z<=1&&((l=N()).id=y.id,l.x=H.x*ge,l.y=H.y*ge,l.z=H.z,l.renderOrder=y.renderOrder,l.object=y,l.rotation=y.rotation,l.scale.x=y.scale.x*Math.abs(l.x-(H.x+f.projectionMatrix.elements[0])/(H.w+f.projectionMatrix.elements[12])),l.scale.y=y.scale.y*Math.abs(l.y-(H.y+f.projectionMatrix.elements[5])/(H.w+f.projectionMatrix.elements[13])),l.material=y.material,T.elements.push(l))}}var Se,Me,Ce,be,ze,Ve,je,Le;return!0===m&&T.elements.sort(F),T}},THREE.SpriteCanvasMaterial=function(e){THREE.Material.call(this),this.type="SpriteCanvasMaterial",this.color=new THREE.Color(16777215),this.program=function(e,t){},this.setValues(e)},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.constructor=THREE.SpriteCanvasMaterial,THREE.SpriteCanvasMaterial.prototype.clone=function(){var e=new THREE.SpriteCanvasMaterial;return e.copy(this),e.color.copy(this.color),e.program=this.program,e},THREE.CanvasRenderer=function(e){console.log("THREE.CanvasRenderer",THREE.REVISION),e=e||{};var t,r,i,n,o,a,s,l,c,p,d,E,h,f,u,m,v,R,x,y=this,T=new THREE.Projector,w=void 0!==e.canvas?e.canvas:document.createElement("canvas"),H=w.width,g=w.height,S=Math.floor(H/2),M=Math.floor(g/2),C=0,b=0,z=H,V=g,j=1,L=w.getContext("2d",{alpha:!0===e.alpha}),O=new THREE.Color(0),B=!0===e.alpha?0:1,W=1,P=0,k=null,N=null,F=null,A=null,I=null,D=[],G=(new THREE.RenderableVertex,new THREE.RenderableVertex,new THREE.Color),U=(new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color),q=new THREE.Color,X=new THREE.Color,J={},Y=new THREE.Box2,$=new THREE.Box2,K=new THREE.Box2,Q=new THREE.Color,Z=new THREE.Color,_=new THREE.Color,ee=new THREE.Vector3,te=new THREE.Vector3,re=new THREE.Vector3,ie=new THREE.Matrix3;function ne(e,t,r){de(r.opacity),Ee(r.blending);var i=t.scale.x*S,n=t.scale.y*M,o=.5*Math.sqrt(i*i+n*n);if(K.min.set(e.x-o,e.y-o),K.max.set(e.x+o,e.y+o),r instanceof THREE.SpriteMaterial){var a=r.map;if(null!==a){var s=J[a.id];if(void 0!==s&&s.version===a.version||(s=le(a),J[a.id]=s),void 0!==s.canvas){ve(s.canvas);var l=a.image,c=l.width*a.offset.x,p=l.height*a.offset.y,d=l.width*a.repeat.x,E=l.height*a.repeat.y,h=i/d,f=n/E;L.save(),L.translate(e.x,e.y),0!==r.rotation&&L.rotate(r.rotation),L.translate(-i/2,-n/2),L.scale(h,f),L.translate(-c,-p),L.fillRect(c,p,d,E),L.restore()}}else ve(r.color.getStyle()),L.save(),L.translate(e.x,e.y),0!==r.rotation&&L.rotate(r.rotation),L.scale(i,-n),L.fillRect(-.5,-.5,1,1),L.restore()}else r instanceof THREE.SpriteCanvasMaterial&&(me(r.color.getStyle()),ve(r.color.getStyle()),L.save(),L.translate(e.x,e.y),0!==r.rotation&&L.rotate(r.rotation),L.scale(i,n),r.program(L),L.restore())}function oe(e,t,r,i){if(de(i.opacity),Ee(i.blending),L.beginPath(),L.moveTo(e.positionScreen.x,e.positionScreen.y),L.lineTo(t.positionScreen.x,t.positionScreen.y),i instanceof THREE.LineBasicMaterial){if(he(i.linewidth),fe(i.linecap),ue(i.linejoin),i.vertexColors!==THREE.VertexColors)me(i.color.getStyle());else{var n=r.vertexColors[0].getStyle(),o=r.vertexColors[1].getStyle();if(n===o)me(n);else{try{var a=L.createLinearGradient(e.positionScreen.x,e.positionScreen.y,t.positionScreen.x,t.positionScreen.y);a.addColorStop(0,n),a.addColorStop(1,o)}catch(e){a=n}me(a)}}L.stroke(),K.expandByScalar(2*i.linewidth)}else i instanceof THREE.LineDashedMaterial&&(he(i.linewidth),fe(i.linecap),ue(i.linejoin),me(i.color.getStyle()),Re([i.dashSize,i.gapSize]),L.stroke(),K.expandByScalar(2*i.linewidth),Re([]))}function ae(e,t,r,i){he(t),fe(r),ue(i),me(e.getStyle()),L.stroke(),K.expandByScalar(2*t)}function se(e){ve(e.getStyle()),L.fill()}function le(e){if(0===e.version||e instanceof THREE.CompressedTexture||e instanceof THREE.DataTexture)return{canvas:void 0,version:e.version};var t=e.image;if(!1===t.complete)return{canvas:void 0,version:0};var r=e.wrapS===THREE.RepeatWrapping||e.wrapS===THREE.MirroredRepeatWrapping,i=e.wrapT===THREE.RepeatWrapping||e.wrapT===THREE.MirroredRepeatWrapping,n=e.wrapS===THREE.MirroredRepeatWrapping,o=e.wrapT===THREE.MirroredRepeatWrapping,a=document.createElement("canvas");a.width=t.width*(n?2:1),a.height=t.height*(o?2:1);var s=a.getContext("2d");s.setTransform(1,0,0,-1,0,t.height),s.drawImage(t,0,0),!0===n&&(s.setTransform(-1,0,0,-1,t.width,t.height),s.drawImage(t,-t.width,0)),!0===o&&(s.setTransform(1,0,0,1,0,0),s.drawImage(t,0,t.height)),!0===n&&!0===o&&(s.setTransform(-1,0,0,1,t.width,0),s.drawImage(t,-t.width,t.height));var l="no-repeat";!0===r&&!0===i?l="repeat":!0===r?l="repeat-x":!0===i&&(l="repeat-y");var c=L.createPattern(a,l);return e.onUpdate&&e.onUpdate(e),{canvas:c,version:e.version}}function ce(e,t,r,i,n,o,a,s,l,c,p,d,E){var h=J[E.id];if(void 0!==h&&h.version===E.version||(h=le(E),J[E.id]=h),void 0===h.canvas)return ve("rgba( 0, 0, 0, 1)"),void L.fill();ve(h.canvas);var f,u,m,v,R,x,y,T,w=E.offset.x/E.repeat.x,H=E.offset.y/E.repeat.y,g=E.image.width*E.repeat.x,S=E.image.height*E.repeat.y;l=(l+w)*g,c=(c+H)*S,p=(p+w)*g,d=(d+H)*S,r-=e,i-=t,n-=e,o-=t,0!=(y=(l-=a=(a+w)*g)*(d-=s=(s+H)*S)-(p-=a)*(c-=s))&&(R=e-(f=(d*r-c*n)*(T=1/y))*a-(m=(l*n-p*r)*T)*s,x=t-(u=(d*i-c*o)*T)*a-(v=(l*o-p*i)*T)*s,L.save(),L.transform(f,u,m,v,R,x),L.fill(),L.restore())}function pe(e,t,r){var i,n=t.x-e.x,o=t.y-e.y,a=n*n+o*o;0!==a&&(n*=i=r/Math.sqrt(a),o*=i,t.x+=n,t.y+=o,e.x-=n,e.y-=o)}function de(e){W!==e&&(L.globalAlpha=e,W=e)}function Ee(e){P!==e&&(e===THREE.NormalBlending?L.globalCompositeOperation="source-over":e===THREE.AdditiveBlending?L.globalCompositeOperation="lighter":e===THREE.SubtractiveBlending?L.globalCompositeOperation="darker":e===THREE.MultiplyBlending&&(L.globalCompositeOperation="multiply"),P=e)}function he(e){F!==e&&(L.lineWidth=e,F=e)}function fe(e){A!==e&&(L.lineCap=e,A=e)}function ue(e){I!==e&&(L.lineJoin=e,I=e)}function me(e){k!==e&&(L.strokeStyle=e,k=e)}function ve(e){N!==e&&(L.fillStyle=e,N=e)}function Re(e){D.length!==e.length&&(L.setLineDash(e),D=e)}void 0===L.setLineDash&&(L.setLineDash=function(){}),this.domElement=w,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.getContext=function(){return L},this.getContextAttributes=function(){return L.getContextAttributes()},this.getPixelRatio=function(){return j},this.setPixelRatio=function(e){void 0!==e&&(j=e)},this.setSize=function(e,t,r){H=e*j,g=t*j,w.width=H,w.height=g,S=Math.floor(H/2),M=Math.floor(g/2),!1!==r&&(w.style.width=e+"px",w.style.height=t+"px"),Y.min.set(-S,-M),Y.max.set(S,M),$.min.set(-S,-M),$.max.set(S,M),W=1,P=0,k=null,N=null,F=null,A=null,I=null,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,i){C=e*j,b=t*j,z=r*j,V=i*j},this.setScissor=function(){},this.setScissorTest=function(){},this.setClearColor=function(e,t){O.set(e),B=void 0!==t?t:1,$.min.set(-S,-M),$.max.set(S,M)},this.setClearColorHex=function(e,t){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return O},this.getClearAlpha=function(){return B},this.getMaxAnisotropy=function(){return 0},this.clear=function(){!1===$.isEmpty()&&($.intersect(Y),$.expandByScalar(2),$.min.x=$.min.x+S,$.min.y=-$.min.y+M,$.max.x=$.max.x+S,$.max.y=-$.max.y+M,B<1&&L.clearRect(0|$.min.x,0|$.max.y,$.max.x-$.min.x|0,$.min.y-$.max.y|0),B>0&&(Ee(THREE.NormalBlending),de(1),ve("rgba("+Math.floor(255*O.r)+","+Math.floor(255*O.g)+","+Math.floor(255*O.b)+","+B+")"),L.fillRect(0|$.min.x,0|$.max.y,$.max.x-$.min.x|0,$.min.y-$.max.y|0)),$.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(e,w){if(w instanceof THREE.Camera!=0){var j=e.background;j&&j.isColor?(ve("rgb("+Math.floor(255*j.r)+","+Math.floor(255*j.g)+","+Math.floor(255*j.b)+")"),L.fillRect(0,0,H,g)):!0===this.autoClear&&this.clear(),y.info.render.vertices=0,y.info.render.faces=0,L.setTransform(z/H,0,0,-V/g,C,g-b),L.translate(S,M),t=T.projectScene(e,w,this.sortObjects,this.sortElements),r=t.elements,i=t.lights,ie.getNormalMatrix(w.matrixWorldInverse),function(){Q.setRGB(0,0,0),Z.setRGB(0,0,0),_.setRGB(0,0,0);for(var e=0,t=i.length;e<t;e++){var r=i[e],n=r.color;r instanceof THREE.AmbientLight?Q.add(n):r instanceof THREE.DirectionalLight?Z.add(n):r instanceof THREE.PointLight&&_.add(n)}}();for(var O=0,B=r.length;O<B;O++){var W=r[O],P=W.material;if(void 0!==P&&0!==P.opacity){if(K.makeEmpty(),W instanceof THREE.RenderableSprite)(n=W).x*=S,n.y*=M,ne(n,W,P);else if(W instanceof THREE.RenderableLine)n=W.v1,o=W.v2,n.positionScreen.x*=S,n.positionScreen.y*=M,o.positionScreen.x*=S,o.positionScreen.y*=M,K.setFromPoints([n.positionScreen,o.positionScreen]),!0===Y.intersectsBox(K)&&oe(n,o,W,P);else if(W instanceof THREE.RenderableFace){if(n=W.v1,o=W.v2,a=W.v3,n.positionScreen.z<-1||n.positionScreen.z>1)continue;if(o.positionScreen.z<-1||o.positionScreen.z>1)continue;if(a.positionScreen.z<-1||a.positionScreen.z>1)continue;n.positionScreen.x*=S,n.positionScreen.y*=M,o.positionScreen.x*=S,o.positionScreen.y*=M,a.positionScreen.x*=S,a.positionScreen.y*=M,P.overdraw>0&&(pe(n.positionScreen,o.positionScreen,P.overdraw),pe(o.positionScreen,a.positionScreen,P.overdraw),pe(a.positionScreen,n.positionScreen,P.overdraw)),K.setFromPoints([n.positionScreen,o.positionScreen,a.positionScreen]),!0===Y.intersectsBox(K)&&(k=n,N=o,F=a,A=0,I=1,D=2,J=W,le=P,he=void 0,fe=void 0,ue=void 0,me=void 0,Re=void 0,xe=void 0,y.info.render.vertices+=3,y.info.render.faces++,de(le.opacity),Ee(le.blending),s=k.positionScreen.x,l=k.positionScreen.y,c=N.positionScreen.x,p=N.positionScreen.y,d=F.positionScreen.x,E=F.positionScreen.y,he=s,fe=l,ue=c,me=p,Re=d,xe=E,L.beginPath(),L.moveTo(he,fe),L.lineTo(ue,me),L.lineTo(Re,xe),L.closePath(),(le instanceof THREE.MeshLambertMaterial||le instanceof THREE.MeshPhongMaterial)&&null===le.map?(U.copy(le.color),q.copy(le.emissive),le.vertexColors===THREE.FaceColors&&U.multiply(J.color),G.copy(Q),te.copy(k.positionWorld).add(N.positionWorld).add(F.positionWorld).divideScalar(3),function(e,t,r){for(var n=0,o=i.length;n<o;n++){var a=i[n];if(X.copy(a.color),a instanceof THREE.DirectionalLight){var s=ee.setFromMatrixPosition(a.matrixWorld).normalize();if((l=t.dot(s))<=0)continue;l*=a.intensity,r.add(X.multiplyScalar(l))}else if(a instanceof THREE.PointLight){var l;if(s=ee.setFromMatrixPosition(a.matrixWorld),(l=t.dot(ee.subVectors(s,e).normalize()))<=0)continue;if(0==(l*=0==a.distance?1:1-Math.min(e.distanceTo(s)/a.distance,1)))continue;l*=a.intensity,r.add(X.multiplyScalar(l))}}}(te,J.normalModel,G),G.multiply(U).add(q),!0===le.wireframe?ae(G,le.wireframeLinewidth,le.wireframeLinecap,le.wireframeLinejoin):se(G)):le instanceof THREE.MeshBasicMaterial||le instanceof THREE.MeshLambertMaterial||le instanceof THREE.MeshPhongMaterial?null!==le.map?le.map.mapping===THREE.UVMapping&&(h=J.uvs,ce(s,l,c,p,d,E,h[A].x,h[A].y,h[I].x,h[I].y,h[D].x,h[D].y,le.map)):null!==le.envMap?le.envMap.mapping===THREE.SphericalReflectionMapping&&(re.copy(J.vertexNormalsModel[A]).applyMatrix3(ie),f=.5*re.x+.5,u=.5*re.y+.5,re.copy(J.vertexNormalsModel[I]).applyMatrix3(ie),m=.5*re.x+.5,v=.5*re.y+.5,re.copy(J.vertexNormalsModel[D]).applyMatrix3(ie),R=.5*re.x+.5,x=.5*re.y+.5,ce(s,l,c,p,d,E,f,u,m,v,R,x,le.envMap)):(G.copy(le.color),le.vertexColors===THREE.FaceColors&&G.multiply(J.color),!0===le.wireframe?ae(G,le.wireframeLinewidth,le.wireframeLinecap,le.wireframeLinejoin):se(G)):le instanceof THREE.MeshNormalMaterial?(re.copy(J.normalModel).applyMatrix3(ie),G.setRGB(re.x,re.y,re.z).multiplyScalar(.5).addScalar(.5),!0===le.wireframe?ae(G,le.wireframeLinewidth,le.wireframeLinecap,le.wireframeLinejoin):se(G)):(G.setRGB(1,1,1),!0===le.wireframe?ae(G,le.wireframeLinewidth,le.wireframeLinecap,le.wireframeLinejoin):se(G)))}$.union(K)}}L.setTransform(1,0,0,1,0,0)}else console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");var k,N,F,A,I,D,J,le,he,fe,ue,me,Re,xe}};